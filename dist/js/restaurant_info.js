let restaurant;
var map;
let restaurantInteractiveMap = false;
let restaurantInitialLoad = true;
/**
 * Lazy Loading Images by setting src attribute only after page load and removing data-src attribute 
 */
// window.addEventListener('DOMContentLoaded', (event) => {
//   console.log("eventlistener...load");
//   let img = document.querySelector('img.restaurant-img[data-src]');
//   img.setAttribute('src', img.getAttribute('data-src'));
//   img.onload = function () {
//     img.removeAttribute('data-src');
//   };
// });

/**
 * Initialize Google map, called from HTML.
 */

window.initMap = () => {
  fetchRestaurantFromURL((error, restaurant) => {
    if (error) {
      // Got an error!
      console.error(error);
    } else {
      // self.map = new google.maps.Map(document.getElementById('map'), {
      //   zoom: 16,
      //   center: restaurant.latlng,
      //   scrollwheel: false
      // });
      fillBreadcrumb(); // DBHelper.mapMarkerForRestaurant(self.restaurant, self.map);
    }
  });
};
/**
 * Displaying Interactive Map onclick of StaticMap
 */


const displayInteractiveMap = event => {
  if (restaurantInteractiveMap) return;
  document.getElementById("restaurantStaticMap").remove();
  self.map = new google.maps.Map(document.getElementById('map'), {
    zoom: 16,
    center: self.restaurant.latlng,
    scrollwheel: false
  });
  DBHelper.mapMarkerForRestaurant(self.restaurant, self.map);
  restaurantInteractiveMap = true;
};
/**
 * Get current restaurant from page URL.
 */


fetchRestaurantFromURL = callback => {
  if (self.restaurant) {
    // restaurant already fetched!
    callback(null, self.restaurant);
    return;
  }

  const id = getParameterByName('id');

  if (!id) {
    // no id found in URL
    error = 'No restaurant id in URL';
    callback(error, null);
  } else {
    DBHelper.fetchRestaurantById(id, (error, restaurant) => {
      self.restaurant = restaurant;

      if (!restaurant) {
        console.error(error);
        return;
      }

      fillRestaurantHTML();
      callback(null, restaurant);
    });
  }
};
/**
 * Create restaurant HTML and add it to the webpage
 */


fillRestaurantHTML = (restaurant = self.restaurant) => {
  const name = document.getElementById('restaurant-name');
  name.innerHTML = restaurant.name;
  const address = document.getElementById('restaurant-address');
  address.innerHTML = restaurant.address;
  const image = document.getElementById('restaurant-img');
  image.className = 'restaurant-img';
  const imageurl = DBHelper.imageUrlForRestaurant(restaurant, "banners");
  const imgparts = imageurl.split(".");
  const imgurl1x = imgparts[0] + "-500w_1x." + imgparts[1];
  const imgurl2x = imgparts[0] + "-800w_2x." + imgparts[1];
  image.src = imgurl1x;
  image.srcset = `${imgurl1x} 500w, ${imgurl2x} 800w`;
  image.alt = restaurant.name + " banner image"; //image.setAttribute('data-src', imgurl1x);

  const cuisine = document.getElementById('restaurant-cuisine');
  cuisine.innerHTML = restaurant.cuisine_type;

  if (restaurantInitialLoad) {
    const url = DBHelper.displayStaticMapOnDetailsPage(restaurant);
    const div = document.getElementById("map");
    const img = document.createElement("img");
    img.id = "restaurantStaticMap";

    img.onclick = e => displayInteractiveMap();

    img.src = url;
    img.alt = "Restaurant Static Map";
    div.append(img);
    restaurantInitialLoad = false;
  } else {
    DBHelper.mapMarkerForRestaurant(self.restaurant, self.map);
  } // fill operating hours


  if (restaurant.operating_hours) {
    fillRestaurantHoursHTML();
  } // fill reviews
  //fillReviewsHTML();


  DBHelper.fetchReviewsByRestaurantId(restaurant.id, fillReviewsHTML);
};
/**
 * Create restaurant operating hours HTML table and add it to the webpage.
 */


fillRestaurantHoursHTML = (operatingHours = self.restaurant.operating_hours) => {
  const title = document.createElement('h3');
  title.innerHTML = 'Hours of Operation';
  const hours = document.getElementById('restaurant-hours');
  hours.insertBefore(title, hours.childNodes[0]);

  for (let key in operatingHours) {
    const row = document.createElement('tr');
    const day = document.createElement('td');
    day.innerHTML = key.trim();
    row.appendChild(day);
    const time = document.createElement('td');
    time.innerHTML = operatingHours[key].trim();
    row.appendChild(time);
    hours.appendChild(row);
  }
};
/**
 * Create all reviews HTML and add them to the webpage.
 */
// fillReviewsHTML = (error, reviews = self.restaurant.reviews) => {


fillReviewsHTML = (error, reviews) => {
  self.restaurant.reviews = reviews;

  if (error) {
    console.log("fillReviewsHTML...", error);
  }

  const container = document.getElementById('reviews-container');
  const reviewsHeading = document.createElement('div');
  reviewsHeading.setAttribute('id', 'reviews-container-heading');
  container.appendChild(reviewsHeading);
  const title = document.createElement('h2');
  title.innerHTML = 'Reviews';
  reviewsHeading.appendChild(title);
  const btnAddAReview = document.createElement('button');
  btnAddAReview.innerHTML = "Add a Review";
  btnAddAReview.setAttribute('id', 'add-review-btn');

  btnAddAReview.onclick = () => {
    newReviewformReset();
    const newReviewForm = document.getElementById('add-review-container');

    if (btnAddAReview.innerHTML == 'Add a Review') {
      newReviewForm.style.display = 'block';
      btnAddAReview.innerHTML = "Hide Add Review";
      reviewsHeading.appendChild(newReviewForm);
    } else {
      btnAddAReview.innerHTML = "Add a Review";
      newReviewForm.style.display = 'none';
    }
  };

  reviewsHeading.appendChild(btnAddAReview);

  if (!reviews) {
    const noReviews = document.createElement('p');
    noReviews.innerHTML = 'No reviews yet!';
    container.appendChild(noReviews);
    return;
  }

  const ul = document.getElementById('reviews-list');
  reviews.forEach(review => {
    ul.appendChild(createReviewHTML(review));
  });
  container.appendChild(ul);
};
/**
 * Create review HTML and add it to the webpage.
 */


createReviewHTML = review => {
  const li = document.createElement('li');

  if (!window.navigator.onLine) {
    const offlineLabel = document.createElement('p');
    offlineLabel.innerHTML = "Offline Mode";
    offlineLabel.classList.add('offline-mode-label');
    li.classList.add('review-offline-mode');
    li.appendChild(offlineLabel);
  }

  const name = document.createElement('p');
  name.innerHTML = review.name;
  li.appendChild(name);
  const date = document.createElement('p');
  let timestamp = new Date(review.createdAt);
  let options = {
    weekday: 'long',
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  };
  date.innerHTML = timestamp.toLocaleDateString("en-US", options);
  li.appendChild(date);
  const rating = document.createElement('p');
  rating.innerHTML = `Rating: ${review.rating}`;
  li.appendChild(rating);
  const comments = document.createElement('p');
  comments.innerHTML = review.comments;
  li.appendChild(comments);
  return li;
};
/**
 * Add restaurant name to the breadcrumb navigation menu
 */


fillBreadcrumb = (restaurant = self.restaurant) => {
  const breadcrumb = document.getElementById('breadcrumb');
  const li = document.createElement('li');
  li.innerHTML = restaurant.name;
  breadcrumb.appendChild(li);
};
/**
 * Get a parameter by name from page URL.
 */


getParameterByName = (name, url) => {
  if (!url) url = window.location.href;
  name = name.replace(/[\[\]]/g, '\\$&');
  const regex = new RegExp(`[?&]${name}(=([^&#]*)|&|#|$)`),
        results = regex.exec(url);
  if (!results) return null;
  if (!results[2]) return '';
  return decodeURIComponent(results[2].replace(/\+/g, ' '));
};

clearErrorMessage = (event, id) => {
  if (event.keyCode === 13) {
    event.preventDefault();
  }

  document.getElementById(`${id}-error`).innerHTML = "";
};

newReviewformReset = () => {
  document.getElementById('new-review-form').reset();
  document.getElementById("reviewer-name-error").innerHTML = "";
  document.getElementById("reviewer-comments-error").innerHTML = "";
};

addReviewHTMLToDOM = reviewObj => {
  const ul = document.getElementById('reviews-list');
  ul.insertBefore(createReviewHTML(reviewObj), ul.childNodes[0]);
};

addNewReview = event => {
  //event.preventDefault();
  const reviewAuthor = document.getElementById("reviewer-name").value;
  const reviewerRating = document.querySelector("#reviewer-rating-select option:checked").value;
  const reviewerComments = document.getElementById("reviewer-comments").value;
  document.getElementById("reviewer-name-error").innerHTML = "";
  document.getElementById("reviewer-comments-error").innerHTML = "";

  if (reviewAuthor == "") {
    document.getElementById("reviewer-name-error").innerHTML = "Please enter your name";
    return false;
  }

  if (reviewerComments == "") {
    document.getElementById("reviewer-comments-error").innerHTML = "Please enter your comments";
    return false;
  }

  document.getElementById("add-review-submit").disabled = true;
  console.log(self.restaurant.id, reviewAuthor, reviewerRating, reviewerComments);
  const reviewObj = {
    "restaurant_id": parseInt(self.restaurant.id),
    "name": reviewAuthor,
    "rating": parseInt(reviewerRating),
    "comments": reviewerComments
  };
  const IDBobj = {
    "restaurant_id": parseInt(self.restaurant.id),
    "name": reviewAuthor,
    "rating": parseInt(reviewerRating),
    "comments": reviewerComments,
    "createdAt": new Date()
  };
  DBHelper.addNewReview(self.restaurant.id, reviewObj, (error, review) => {
    if (error) {
      console.log("Unable to add new review to server", error);
    }

    document.getElementById("add-review-submit").disabled = false;
  });
  addReviewHTMLToDOM(IDBobj);
  newReviewformReset();
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJyZXN0YXVyYW50IiwibWFwIiwicmVzdGF1cmFudEludGVyYWN0aXZlTWFwIiwicmVzdGF1cmFudEluaXRpYWxMb2FkIiwid2luZG93IiwiaW5pdE1hcCIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJlcnJvciIsImNvbnNvbGUiLCJmaWxsQnJlYWRjcnVtYiIsImRpc3BsYXlJbnRlcmFjdGl2ZU1hcCIsImV2ZW50IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInJlbW92ZSIsInNlbGYiLCJnb29nbGUiLCJtYXBzIiwiTWFwIiwiem9vbSIsImNlbnRlciIsImxhdGxuZyIsInNjcm9sbHdoZWVsIiwiREJIZWxwZXIiLCJtYXBNYXJrZXJGb3JSZXN0YXVyYW50IiwiY2FsbGJhY2siLCJpZCIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJuYW1lIiwiaW5uZXJIVE1MIiwiYWRkcmVzcyIsImltYWdlIiwiY2xhc3NOYW1lIiwiaW1hZ2V1cmwiLCJpbWFnZVVybEZvclJlc3RhdXJhbnQiLCJpbWdwYXJ0cyIsInNwbGl0IiwiaW1ndXJsMXgiLCJpbWd1cmwyeCIsInNyYyIsInNyY3NldCIsImFsdCIsImN1aXNpbmUiLCJjdWlzaW5lX3R5cGUiLCJ1cmwiLCJkaXNwbGF5U3RhdGljTWFwT25EZXRhaWxzUGFnZSIsImRpdiIsImltZyIsImNyZWF0ZUVsZW1lbnQiLCJvbmNsaWNrIiwiZSIsImFwcGVuZCIsIm9wZXJhdGluZ19ob3VycyIsImZpbGxSZXN0YXVyYW50SG91cnNIVE1MIiwiZmV0Y2hSZXZpZXdzQnlSZXN0YXVyYW50SWQiLCJmaWxsUmV2aWV3c0hUTUwiLCJvcGVyYXRpbmdIb3VycyIsInRpdGxlIiwiaG91cnMiLCJpbnNlcnRCZWZvcmUiLCJjaGlsZE5vZGVzIiwia2V5Iiwicm93IiwiZGF5IiwidHJpbSIsImFwcGVuZENoaWxkIiwidGltZSIsInJldmlld3MiLCJsb2ciLCJjb250YWluZXIiLCJyZXZpZXdzSGVhZGluZyIsInNldEF0dHJpYnV0ZSIsImJ0bkFkZEFSZXZpZXciLCJuZXdSZXZpZXdmb3JtUmVzZXQiLCJuZXdSZXZpZXdGb3JtIiwic3R5bGUiLCJkaXNwbGF5Iiwibm9SZXZpZXdzIiwidWwiLCJmb3JFYWNoIiwicmV2aWV3IiwiY3JlYXRlUmV2aWV3SFRNTCIsImxpIiwibmF2aWdhdG9yIiwib25MaW5lIiwib2ZmbGluZUxhYmVsIiwiY2xhc3NMaXN0IiwiYWRkIiwiZGF0ZSIsInRpbWVzdGFtcCIsIkRhdGUiLCJjcmVhdGVkQXQiLCJvcHRpb25zIiwid2Vla2RheSIsInllYXIiLCJtb250aCIsInRvTG9jYWxlRGF0ZVN0cmluZyIsInJhdGluZyIsImNvbW1lbnRzIiwiYnJlYWRjcnVtYiIsImxvY2F0aW9uIiwiaHJlZiIsInJlcGxhY2UiLCJyZWdleCIsIlJlZ0V4cCIsInJlc3VsdHMiLCJleGVjIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiY2xlYXJFcnJvck1lc3NhZ2UiLCJrZXlDb2RlIiwicHJldmVudERlZmF1bHQiLCJyZXNldCIsImFkZFJldmlld0hUTUxUb0RPTSIsInJldmlld09iaiIsImFkZE5ld1JldmlldyIsInJldmlld0F1dGhvciIsInZhbHVlIiwicmV2aWV3ZXJSYXRpbmciLCJxdWVyeVNlbGVjdG9yIiwicmV2aWV3ZXJDb21tZW50cyIsImRpc2FibGVkIiwicGFyc2VJbnQiLCJJREJvYmoiXSwibWFwcGluZ3MiOiJBQUFBLElBQUlBLFVBQUo7QUFDQSxJQUFJQyxHQUFKO0FBQ0EsSUFBSUMsd0JBQXdCLEdBQUcsS0FBL0I7QUFDQSxJQUFJQyxxQkFBcUIsR0FBRyxJQUE1QjtBQUVBOzs7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUtBOzs7O0FBR0FDLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixNQUFNO0FBQ3JCQyxFQUFBQSxzQkFBc0IsQ0FBQyxDQUFD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MkYsWUFGUTtBQUdoQixjQUFVTSxRQUFRLENBQUNKLGNBQUQsQ0FIRjtBQUloQixnQkFBWUU7QUFKSSxHQUFsQjtBQU9BLFFBQU1HLE1BQU0sR0FBRztBQUNiLHFCQUFpQkQsUUFBUSxDQUFDNUcsSUFBSSxDQUFDZixVQUFMLENBQWdCMEIsRUFBakIsQ0FEWjtBQUViLFlBQVEyRixZQUZLO0FBR2IsY0FBVU0sUUFBUSxDQUFDSixjQUFELENBSEw7QUFJYixnQkFBWUUsZ0JBSkM7QUFLYixpQkFBYSxJQUFJN0IsSUFBSjtBQUxBLEdBQWY7QUFRQXJFLEVBQUFBLFFBQVEsQ0FBQzZGLFlBQVQsQ0FBc0JyRyxJQUFJLENBQUNmLFVBQUwsQ0FBZ0IwQixFQUF0QyxFQUEwQ3lGLFNBQTFDLEVBQXFELENBQUM1RyxLQUFELEVBQVEyRSxNQUFSLEtBQW1CO0FBQ3RFLFFBQUkzRSxLQUFKLEVBQVc7QUFDVEMsTUFBQUEsT0FBTyxDQUFDOEQsR0FBUixDQUFZLG9DQUFaLEVBQWtEL0QsS0FBbEQ7QUFDRDs7QUFDREssSUFBQUEsUUFBUSxDQUFDQyxjQUFULENBQXdCLG1CQUF4QixFQUE2QzZHLFFBQTdDLEdBQXdELEtBQXhEO0FBQ0QsR0FMRDtBQU9BUixFQUFBQSxrQkFBa0IsQ0FBQ1UsTUFBRCxDQUFsQjtBQUNBakQsRUFBQUEsa0JBQWtCO0FBRW5CLENBN0NEIiwic291cmNlc0NvbnRlbnQiOlsibGV0IHJlc3RhdXJhbnQ7XG52YXIgbWFwO1xubGV0IHJlc3RhdXJhbnRJbnRlcmFjdGl2ZU1hcCA9IGZhbHNlO1xubGV0IHJlc3RhdXJhbnRJbml0aWFsTG9hZCA9IHRydWU7XG5cbi8qKlxuICogTGF6eSBMb2FkaW5nIEltYWdlcyBieSBzZXR0aW5nIHNyYyBhdHRyaWJ1dGUgb25seSBhZnRlciBwYWdlIGxvYWQgYW5kIHJlbW92aW5nIGRhdGEtc3JjIGF0dHJpYnV0ZSBcbiAqL1xuLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcbi8vICAgY29uc29sZS5sb2coXCJldmVudGxpc3RlbmVyLi4ubG9hZFwiKTtcbi8vICAgbGV0IGltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2ltZy5yZXN0YXVyYW50LWltZ1tkYXRhLXNyY10nKTtcblxuLy8gICBpbWcuc2V0QXR0cmlidXRlKCdzcmMnLCBpbWcuZ2V0QXR0cmlidXRlKCdkYXRhLXNyYycpKTtcbi8vICAgaW1nLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbi8vICAgICBpbWcucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXNyYycpO1xuLy8gICB9O1xuLy8gfSk7XG5cblxuXG5cbi8qKlxuICogSW5pdGlhbGl6ZSBHb29nbGUgbWFwLCBjYWxsZWQgZnJvbSBIVE1MLlxuICovXG53aW5kb3cuaW5pdE1hcCA9ICgpID0+IHtcbiAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIHNlbGYubWFwID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyksIHtcbiAgICAgIC8vICAgem9vbTogMTYsXG4gICAgICAvLyAgIGNlbnRlcjogcmVzdGF1cmFudC5sYXRsbmcsXG4gICAgICAvLyAgIHNjcm9sbHdoZWVsOiBmYWxzZVxuICAgICAgLy8gfSk7XG4gICAgICBmaWxsQnJlYWRjcnVtYigpO1xuICAgICAgLy8gREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqIERpc3BsYXlpbmcgSW50ZXJhY3RpdmUgTWFwIG9uY2xpY2sgb2YgU3RhdGljTWFwXG4gKi9cbmNvbnN0IGRpc3BsYXlJbnRlcmFjdGl2ZU1hcCA9IGV2ZW50ID0+IHtcbiAgaWYgKHJlc3RhdXJhbnRJbnRlcmFjdGl2ZU1hcClcbiAgICByZXR1cm47XG5cbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXN0YXVyYW50U3RhdGljTWFwXCIpLnJlbW92ZSgpO1xuICBzZWxmLm1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21hcCcpLCB7XG4gICAgICAgIHpvb206IDE2LFxuICAgICAgICBjZW50ZXI6IHNlbGYucmVzdGF1cmFudC5sYXRsbmcsXG4gICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxuICB9KTtcbiAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcbiAgcmVzdGF1cmFudEludGVyYWN0aXZlTWFwID0gdHJ1ZTtcbn07XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgcmVzdGF1cmFudCBmcm9tIHBhZ2UgVVJMLlxuICovXG5mZXRjaFJlc3RhdXJhbnRGcm9tVVJMID0gKGNhbGxiYWNrKSA9PiB7XG4gIGlmIChzZWxmLnJlc3RhdXJhbnQpIHsgLy8gcmVzdGF1cmFudCBhbHJlYWR5IGZldGNoZWQhXG4gICAgY2FsbGJhY2sobnVsbCwgc2VsZi5yZXN0YXVyYW50KVxuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCBpZCA9IGdldFBhcmFtZXRlckJ5TmFtZSgnaWQnKTtcbiAgaWYgKCFpZCkgeyAvLyBubyBpZCBmb3VuZCBpbiBVUkxcbiAgICBlcnJvciA9ICdObyByZXN0YXVyYW50IGlkIGluIFVSTCdcbiAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XG4gIH0gZWxzZSB7XG4gICAgREJIZWxwZXIuZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgKGVycm9yLCByZXN0YXVyYW50KSA9PiB7XG4gICAgICBzZWxmLnJlc3RhdXJhbnQgPSByZXN0YXVyYW50O1xuICAgICAgaWYgKCFyZXN0YXVyYW50KSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9ICAgICBcbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xuICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxuICovXG5maWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtbmFtZScpO1xuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jlc3RhdXJhbnQtYWRkcmVzcycpO1xuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcblxuICBjb25zdCBpbWFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWltZycpO1xuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnXG4gIGNvbnN0IGltYWdldXJsID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIFwiYmFubmVyc1wiKTtcbiAgY29uc3QgaW1ncGFydHMgPSBpbWFnZXVybC5zcGxpdChcIi5cIik7XG4gIGNvbnN0IGltZ3VybDF4ID0gaW1ncGFydHNbMF0gKyBcIi01MDB3XzF4LlwiICsgaW1ncGFydHNbMV07XG4gIGNvbnN0IGltZ3VybDJ4ID0gaW1ncGFydHNbMF0gKyBcIi04MDB3XzJ4LlwiICsgaW1ncGFydHNbMV07XG4gIGltYWdlLnNyYyA9IGltZ3VybDF4O1xuICBpbWFnZS5zcmNzZXQgPSBgJHtpbWd1cmwxeH0gNTAwdywgJHtpbWd1cmwyeH0gODAwd2A7XG4gIGltYWdlLmFsdCA9IHJlc3RhdXJhbnQubmFtZSArIFwiIGJhbm5lciBpbWFnZVwiO1xuICAvL2ltYWdlLnNldEF0dHJpYnV0ZSgnZGF0YS1zcmMnLCBpbWd1cmwxeCk7XG5cbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdyZXN0YXVyYW50LWN1aXNpbmUnKTtcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuICBpZiAocmVzdGF1cmFudEluaXRpYWxMb2FkKSB7XG4gICAgY29uc3QgdXJsID0gREJIZWxwZXIuZGlzcGxheVN0YXRpY01hcE9uRGV0YWlsc1BhZ2UocmVzdGF1cmFudCk7XG4gICAgY29uc3QgZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYXBcIik7XG4gICAgY29uc3QgaW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcbiAgICBpbWcuaWQgPSBcInJlc3RhdXJhbnRTdGF0aWNNYXBcIjtcbiAgICBpbWcub25jbGljayA9IGUgPT4gZGlzcGxheUludGVyYWN0aXZlTWFwKCk7XG4gICAgaW1nLnNyYyA9IHVybDtcbiAgICBpbWcuYWx0ID0gXCJSZXN0YXVyYW50IFN0YXRpYyBNYXBcIjtcbiAgICBkaXYuYXBwZW5kKGltZyk7XG5cbiAgICByZXN0YXVyYW50SW5pdGlhbExvYWQgPSBmYWxzZTtcbiAgfWVsc2V7XG4gICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwKTtcbiAgfVxuXG4gIC8vIGZpbGwgb3BlcmF0aW5nIGhvdXJzXG4gIGlmIChyZXN0YXVyYW50Lm9wZXJhdGluZ19ob3Vycykge1xuICAgIGZpbGxSZXN0YXVyYW50SG91cnNIVE1MKCk7XG4gIH1cbiAgLy8gZmlsbCByZXZpZXdzXG4gIC8vZmlsbFJldmlld3NIVE1MKCk7XG4gIERCSGVscGVyLmZldGNoUmV2aWV3c0J5UmVzdGF1cmFudElkKHJlc3RhdXJhbnQuaWQsIGZpbGxSZXZpZXdzSFRNTCk7XG59XG5cbi8qKlxuICogQ3JlYXRlIHJlc3RhdXJhbnQgb3BlcmF0aW5nIGhvdXJzIEhUTUwgdGFibGUgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZS5cbiAqL1xuZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwgPSAob3BlcmF0aW5nSG91cnMgPSBzZWxmLnJlc3RhdXJhbnQub3BlcmF0aW5nX2hvdXJzKSA9PiB7XG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDMnKTtcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ0hvdXJzIG9mIE9wZXJhdGlvbic7XG5cbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVzdGF1cmFudC1ob3VycycpO1xuICBob3Vycy5pbnNlcnRCZWZvcmUodGl0bGUsIGhvdXJzLmNoaWxkTm9kZXNbMF0pO1xuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuICAgIGNvbnN0IGRheSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgZGF5LmlubmVySFRNTCA9IGtleS50cmltKCk7XG4gICAgcm93LmFwcGVuZENoaWxkKGRheSk7XG5cbiAgICBjb25zdCB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICB0aW1lLmlubmVySFRNTCA9IG9wZXJhdGluZ0hvdXJzW2tleV0udHJpbSgpO1xuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcbiAgICBob3Vycy5hcHBlbmRDaGlsZChyb3cpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGFsbCByZXZpZXdzIEhUTUwgYW5kIGFkZCB0aGVtIHRvIHRoZSB3ZWJwYWdlLlxuICovXG4vLyBmaWxsUmV2aWV3c0hUTUwgPSAoZXJyb3IsIHJldmlld3MgPSBzZWxmLnJlc3RhdXJhbnQucmV2aWV3cykgPT4ge1xuZmlsbFJldmlld3NIVE1MID0gKGVycm9yLCByZXZpZXdzKSA9PiB7XG4gIHNlbGYucmVzdGF1cmFudC5yZXZpZXdzID0gcmV2aWV3cztcblxuICBpZiAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZyhcImZpbGxSZXZpZXdzSFRNTC4uLlwiLCBlcnJvcik7XG4gIH1cbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Jldmlld3MtY29udGFpbmVyJyk7XG4gIGNvbnN0IHJldmlld3NIZWFkaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIHJldmlld3NIZWFkaW5nLnNldEF0dHJpYnV0ZSgnaWQnLCAncmV2aWV3cy1jb250YWluZXItaGVhZGluZycpO1xuICBjb250YWluZXIuYXBwZW5kQ2hpbGQocmV2aWV3c0hlYWRpbmcpO1xuXG4gIGNvbnN0IHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDInKTtcbiAgdGl0bGUuaW5uZXJIVE1MID0gJ1Jldmlld3MnO1xuICByZXZpZXdzSGVhZGluZy5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cbiAgY29uc3QgYnRuQWRkQVJldmlldyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2J1dHRvbicpO1xuICBidG5BZGRBUmV2aWV3LmlubmVySFRNTCA9IFwiQWRkIGEgUmV2aWV3XCI7XG4gIGJ0bkFkZEFSZXZpZXcuc2V0QXR0cmlidXRlKCdpZCcsICdhZGQtcmV2aWV3LWJ0bicpO1xuICBidG5BZGRBUmV2aWV3Lm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgbmV3UmV2aWV3Zm9ybVJlc2V0KCk7XG4gICAgY29uc3QgbmV3UmV2aWV3Rm9ybSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGQtcmV2aWV3LWNvbnRhaW5lcicpO1xuXG4gICAgaWYgKGJ0bkFkZEFSZXZpZXcuaW5uZXJIVE1MID09ICdBZGQgYSBSZXZpZXcnKSB7XG4gICAgICBuZXdSZXZpZXdGb3JtLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snO1xuICAgICAgYnRuQWRkQVJldmlldy5pbm5lckhUTUwgPSBcIkhpZGUgQWRkIFJldmlld1wiO1xuICAgICAgcmV2aWV3c0hlYWRpbmcuYXBwZW5kQ2hpbGQobmV3UmV2aWV3Rm9ybSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ0bkFkZEFSZXZpZXcuaW5uZXJIVE1MID0gXCJBZGQgYSBSZXZpZXdcIjtcbiAgICAgIG5ld1Jldmlld0Zvcm0uc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG4gIH1cbiAgcmV2aWV3c0hlYWRpbmcuYXBwZW5kQ2hpbGQoYnRuQWRkQVJldmlldyk7XG5cbiAgaWYgKCFyZXZpZXdzKSB7XG4gICAgY29uc3Qgbm9SZXZpZXdzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJztcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XG4gIHJldmlld3MuZm9yRWFjaChyZXZpZXcgPT4ge1xuICAgIHVsLmFwcGVuZENoaWxkKGNyZWF0ZVJldmlld0hUTUwocmV2aWV3KSk7XG4gIH0pO1xuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodWwpO1xufVxuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG5cbiAgaWYgKCF3aW5kb3cubmF2aWdhdG9yLm9uTGluZSkge1xuICAgIGNvbnN0IG9mZmxpbmVMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgICBvZmZsaW5lTGFiZWwuaW5uZXJIVE1MID0gXCJPZmZsaW5lIE1vZGVcIjtcbiAgICBvZmZsaW5lTGFiZWwuY2xhc3NMaXN0LmFkZCgnb2ZmbGluZS1tb2RlLWxhYmVsJyk7XG4gICAgbGkuY2xhc3NMaXN0LmFkZCgncmV2aWV3LW9mZmxpbmUtbW9kZScpO1xuICAgIGxpLmFwcGVuZENoaWxkKG9mZmxpbmVMYWJlbCk7XG4gIH1cblxuICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBuYW1lLmlubmVySFRNTCA9IHJldmlldy5uYW1lO1xuICBsaS5hcHBlbmRDaGlsZChuYW1lKTtcblxuICBjb25zdCBkYXRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBsZXQgdGltZXN0YW1wID0gbmV3IERhdGUocmV2aWV3LmNyZWF0ZWRBdCk7XG4gIGxldCBvcHRpb25zID0geyB3ZWVrZGF5OiAnbG9uZycsIHllYXI6ICdudW1lcmljJywgbW9udGg6ICdsb25nJywgZGF5OiAnbnVtZXJpYycgfTtcblxuICBkYXRlLmlubmVySFRNTCA9IHRpbWVzdGFtcC50b0xvY2FsZURhdGVTdHJpbmcoXCJlbi1VU1wiLCBvcHRpb25zKTtcbiAgbGkuYXBwZW5kQ2hpbGQoZGF0ZSk7XG5cbiAgY29uc3QgcmF0aW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICByYXRpbmcuaW5uZXJIVE1MID0gYFJhdGluZzogJHtyZXZpZXcucmF0aW5nfWA7XG4gIGxpLmFwcGVuZENoaWxkKHJhdGluZyk7XG5cbiAgY29uc3QgY29tbWVudHMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGNvbW1lbnRzLmlubmVySFRNTCA9IHJldmlldy5jb21tZW50cztcbiAgbGkuYXBwZW5kQ2hpbGQoY29tbWVudHMpO1xuXG4gIHJldHVybiBsaTtcbn1cblxuLyoqXG4gKiBBZGQgcmVzdGF1cmFudCBuYW1lIHRvIHRoZSBicmVhZGNydW1iIG5hdmlnYXRpb24gbWVudVxuICovXG5maWxsQnJlYWRjcnVtYiA9IChyZXN0YXVyYW50ID0gc2VsZi5yZXN0YXVyYW50KSA9PiB7XG4gIGNvbnN0IGJyZWFkY3J1bWIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnJlYWRjcnVtYicpO1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIGxpLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcbiAgYnJlYWRjcnVtYi5hcHBlbmRDaGlsZChsaSk7XG59XG5cbi8qKlxuICogR2V0IGEgcGFyYW1ldGVyIGJ5IG5hbWUgZnJvbSBwYWdlIFVSTC5cbiAqL1xuZ2V0UGFyYW1ldGVyQnlOYW1lID0gKG5hbWUsIHVybCkgPT4ge1xuICBpZiAoIXVybClcbiAgICB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjtcbiAgbmFtZSA9IG5hbWUucmVwbGFjZSgvW1xcW1xcXV0vZywgJ1xcXFwkJicpO1xuICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYFs/Jl0ke25hbWV9KD0oW14mI10qKXwmfCN8JClgKSxcbiAgICByZXN1bHRzID0gcmVnZXguZXhlYyh1cmwpO1xuICBpZiAoIXJlc3VsdHMpXG4gICAgcmV0dXJuIG51bGw7XG4gIGlmICghcmVzdWx0c1syXSlcbiAgICByZXR1cm4gJyc7XG4gIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocmVzdWx0c1syXS5yZXBsYWNlKC9cXCsvZywgJyAnKSk7XG59XG5cbmNsZWFyRXJyb3JNZXNzYWdlID0gKGV2ZW50LCBpZCkgPT4ge1xuICBpZiAoZXZlbnQua2V5Q29kZSA9PT0gMTMpIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke2lkfS1lcnJvcmApLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbm5ld1Jldmlld2Zvcm1SZXNldCA9ICgpID0+IHtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25ldy1yZXZpZXctZm9ybScpLnJlc2V0KCk7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmV2aWV3ZXItbmFtZS1lcnJvclwiKS5pbm5lckhUTUwgPSBcIlwiO1xuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJldmlld2VyLWNvbW1lbnRzLWVycm9yXCIpLmlubmVySFRNTCA9IFwiXCI7XG59XG5cbmFkZFJldmlld0hUTUxUb0RPTSA9IChyZXZpZXdPYmopID0+IHtcbiAgY29uc3QgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmV2aWV3cy1saXN0Jyk7XG4gIHVsLmluc2VydEJlZm9yZShjcmVhdGVSZXZpZXdIVE1MKHJldmlld09iaiksIHVsLmNoaWxkTm9kZXNbMF0pO1xufVxuXG5hZGROZXdSZXZpZXcgPSAoZXZlbnQpID0+IHtcbiAgLy9ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICBjb25zdCByZXZpZXdBdXRob3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJldmlld2VyLW5hbWVcIikudmFsdWU7XG4gIGNvbnN0IHJldmlld2VyUmF0aW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNyZXZpZXdlci1yYXRpbmctc2VsZWN0IG9wdGlvbjpjaGVja2VkXCIpLnZhbHVlO1xuICBjb25zdCByZXZpZXdlckNvbW1lbnRzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXZpZXdlci1jb21tZW50c1wiKS52YWx1ZTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJyZXZpZXdlci1uYW1lLWVycm9yXCIpLmlubmVySFRNTCA9IFwiXCI7XG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmV2aWV3ZXItY29tbWVudHMtZXJyb3JcIikuaW5uZXJIVE1MID0gXCJcIjtcblxuICBpZiAocmV2aWV3QXV0aG9yID09IFwiXCIpIHtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInJldmlld2VyLW5hbWUtZXJyb3JcIikuaW5uZXJIVE1MID0gXCJQbGVhc2UgZW50ZXIgeW91ciBuYW1lXCI7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgaWYgKHJldmlld2VyQ29tbWVudHMgPT0gXCJcIikge1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwicmV2aWV3ZXItY29tbWVudHMtZXJyb3JcIikuaW5uZXJIVE1MID0gXCJQbGVhc2UgZW50ZXIgeW91ciBjb21tZW50c1wiO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWRkLXJldmlldy1zdWJtaXRcIikuZGlzYWJsZWQgPSB0cnVlO1xuICBjb25zb2xlLmxvZyhzZWxmLnJlc3RhdXJhbnQuaWQsIHJldmlld0F1dGhvciwgcmV2aWV3ZXJSYXRpbmcsIHJldmlld2VyQ29tbWVudHMpO1xuICBjb25zdCByZXZpZXdPYmogPSB7XG4gICAgXCJyZXN0YXVyYW50X2lkXCI6IHBhcnNlSW50KHNlbGYucmVzdGF1cmFudC5pZCksXG4gICAgXCJuYW1lXCI6IHJldmlld0F1dGhvcixcbiAgICBcInJhdGluZ1wiOiBwYXJzZUludChyZXZpZXdlclJhdGluZyksXG4gICAgXCJjb21tZW50c1wiOiByZXZpZXdlckNvbW1lbnRzXG4gIH07XG5cbiAgY29uc3QgSURCb2JqID0ge1xuICAgIFwicmVzdGF1cmFudF9pZFwiOiBwYXJzZUludChzZWxmLnJlc3RhdXJhbnQuaWQpLFxuICAgIFwibmFtZVwiOiByZXZpZXdBdXRob3IsXG4gICAgXCJyYXRpbmdcIjogcGFyc2VJbnQocmV2aWV3ZXJSYXRpbmcpLFxuICAgIFwiY29tbWVudHNcIjogcmV2aWV3ZXJDb21tZW50cyxcbiAgICBcImNyZWF0ZWRBdFwiOiBuZXcgRGF0ZSgpXG4gIH1cblxuICBEQkhlbHBlci5hZGROZXdSZXZpZXcoc2VsZi5yZXN0YXVyYW50LmlkLCByZXZpZXdPYmosIChlcnJvciwgcmV2aWV3KSA9PiB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIlVuYWJsZSB0byBhZGQgbmV3IHJldmlldyB0byBzZXJ2ZXJcIiwgZXJyb3IpO1xuICAgIH1cbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFkZC1yZXZpZXctc3VibWl0XCIpLmRpc2FibGVkID0gZmFsc2U7XG4gIH0pO1xuXG4gIGFkZFJldmlld0hUTUxUb0RPTShJREJvYmopO1xuICBuZXdSZXZpZXdmb3JtUmVzZXQoKTtcblxufSJdLCJmaWxlIjoicmVzdGF1cmFudF9pbmZvLmpzIn0=
